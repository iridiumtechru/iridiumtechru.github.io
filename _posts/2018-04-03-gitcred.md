---
layout: post
published: true
title: Git авторизация для Visual Studio Code
---

Среда с интегрированной системой контроля версий.

------
## Зачем?
*В последнее время для всех сторонних проектов использую VSCode в купе с git. Мне очень нравится возможность иметь все инструменты под рукой и вести контроль версий не отрываясь от разработки. Единственной проблемой является то что Git всегда переспрашивает логин/пароль при работе с внешним репозиторием. Сделаем среду максимально удобной.*

Для этого сгенерируем ключ для удаленного доступа, укажем его в настройках репозитория и укажем git'e где лежит ключ.
Ключ состоит из двуха частей: публичной и приватной. Публичная загружается на удаленный сервер, приватная используется для авторизации. Из приватной можно восстановить публичную. Также ключ может содержать пароль (passphrase) для защиты от потери приватного ключа.

Первым делом придется разобраться с генерацией ключа. Для этого придется понять чем отличаются [openssl openssh и puttygen]({{ site.url }}{% post_url 2018-04-01-generate-certificates %}).

## Загружаем публичный ключ в репозиторий.

Заходим в настройки репозитория.

### GitHub

`Settings -> Deploy Keys -> Add deploy key`

Вставляем имя и текст публичного ключа (он обычно начинается с ssh-rsa). Даем ключу **права на запись** (Allow write access). Сохраняем.

## Добавляем приватный ключ

### Linux
Приватный ключ должен лежать в папке `~/.ssh`. Именем по-умолчанию должно быть `id_rsa`.

Если ключей несколько используем `~/.ssh/config` файл.

## Меняем git remote

Посмотреть текущий внешний репозиторий:

`git remote -v`

Сменить адрес репозитория на ssh:

`git remote set-url origin git@github.com:iridiumtechru/iridiumtechru.github.io.git`

## Проверям пуш

<details>
    <summary>
        <code class="highlighter-rouge">
            git push origin
        </code>
    </summary>
    <pre class="highlight">
        <code>
            The authenticity of host 'github.com (192.30.253.113)' can't be established.
            RSA key fingerprint is SHA256:nThbg6kXUpJWGl7E1IGOCspRomTxdCARLviKw6E5SY8.
            Are you sure you want to continue connecting (yes/no)? yes
            Warning: Permanently added 'github.com,192.30.253.113' (RSA) to the list of known hosts.
            Everything up-to-date
        </code>
    </pre>
</details>


**Ctrl+Shift+P** -> **Push To**

![Push Test]({{"/assets/push.jpg" | absolute_url}})

Будет запрошен пароль от сертификата. Если не хочется его вводить постоянно, создать сертификат без пароля.

### Windows

Запускаем **Git Bash**, создаем папку `~/.ssh`. Скорее всего это будет папка пользователя.

Переходим в паку репозитория

`git push origin`

The authenticity of host 'github.com (192.30.253.112)' can't be established.
RSA key fingerprint is SHA256:nThbg6kXUpJWGl7E1IGO1spRomTxdCARLviKw6E5SY8.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'github.com,192.30.253.112' (RSA) to the list of known hosts.
Enter passphrase for key '/c/Users/TECHRUMAIN/.ssh/id_rsa':

Удалось **запустить из терминала Git Bash**. Так Push работает, запрашивая пароль от сертификата. Пришлось отключить в настройках:

`"git.autofetch": false,`

и сравнить отличие переменных `printenv`

Попробуем зайти с другой стороны. Используем Credential manager встроенный в Windows.

## Ссылки
1. [ssh/config](https://linux.die.net/man/5/ssh_config)
