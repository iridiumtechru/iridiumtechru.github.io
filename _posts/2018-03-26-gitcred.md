---
layout: post
published: false
title: Git Credentials для Visual Studio Code
---

Среда с интегрированной системой контроля версий.

## Зачем?
*В последнее время для всех сторонних проектов использую VSCode в купе с git. Мне очень нравится возможность иметь все инструменты под рукой и вести контроль версий не отрываясь от разработки. Единственной проблемой является то что Git всегда переспрашивает логин/пароль при работе с внешним репозиторием. Сделаем среду максимально удобной.*

Первым делом придется разобраться с генерацией ключа. Для этого придется понять чем отличаются `openssl openssh и puttygen`.

## Инструкция для Linux

### openssl

<details>
    <summary>
        <code class="highlighter-rouge">
            openssl req -x509 -newkey rsa:2048 -keyout openssl-key.pem -out openssl.pub -days 365
        </code>
    </summary>
    <pre class="highlight">
        <code>
            Generating a 2048 bit RSA private key...............+++
            ..........................................+++
            writing new private key to 'okey.pem'
            Enter PEM pass phrase:
            Verifying - Enter PEM pass phrase:
            -----
            You are about to be asked to enter information that will be incorporated
            into your certificate request.What you are about to enter is what is called a Distinguished Name or a DN.There are quite a few fields but you can leave some blankFor some fields there will be a default value,
            If you enter '.', the field will be left blank.
            -----
            Country Name (2 letter code) [AU]:
            State or Province Name (full name) [Some-State]:
            Locality Name (eg, city) []:
            Organization Name (eg, company) [Internet Widgits Pty Ltd]:
            Organizational Unit Name (eg, section) []:
            Common Name (e.g. server FQDN or YOUR name) []:
            Email Address []:
        </code>
    </pre>
</details>

~~Нужен для генерации сертификатов сайтов~~

### ssh-keygen

<details>
    <summary>
        <code class="highlighter-rouge">
            ssh-keygen
        </code>
    </summary>
    <pre class="highlight">
        <code>
            Enter passphrase (empty for no passphrase):
            Enter same passphrase again:
            Your identification has been saved in ./ssh-key.
            Your public key has been saved in ./ssh-key.pub.
            The key fingerprint is:
            SHA256:Aexx4t1BfpFvMkPaOrhBPjt7n7qkNHh6clfkm53eEpg techru@techru-GA-770TA-UD3
            The key's randomart image is:
            +---[RSA 2048]----+
            |     ..  .. ..   |
            |      +.... o.   |
            |     o =...=..   |
            |      o o.o.* o  |
            |       oS. + B   |
            |       .= o E .  |
            |      . +=.o + o |
            |      .+*+o o.+. |
            |      .+o=o+o....|
            +----[SHA256]-----+
        </code>
    </pre>
</details>
По-умолчанию генерирует файлы `~/.ssh/id_rsa` и `~/.ssh/id_rsa.pub`

Я сгенерировал в текущую папку с именем **ssh-key**

### puttygen

Для начал установим его

```sudo apt install putty-tools```

Генерируем приватный ключ(очень долго):

<details>
    <summary>
        <code class="highlighter-rouge">
            puttygen -t rsa -b 2048 -C "email@host.com" -o putty-key.ppk
        </code>
    </summary>
    <pre class="highlight">
        <code>
            ++++++++++++++++++++++++++++++++++
            ++++
            +++++
            Enter passphrase to save key:
            Re-enter passphrase to verify:
        </code>
    </pre>
</details>

И генерируем из него публичный:

`puttygen -L putty-key.ppk > putty-key.pub`

Я генерировал всё в один каталог. Его содержимое:

```bash
-rw-rw-r-- techru 1834 openssl-key.pem
-rw-rw-r-- techru 1229 openssl.pub
-rw------- techru 1766 ssh-key
-rw-r--r-- techru  408 ssh-key.pub
-rw------- techru 1454 putty-key.ppk
-rw-rw-r-- techru  396 putty-key.pub
```

!Каждый ключ состоит из публичной и приватной части.

## Меняем git remote

Посмотреть текущий внешний репозиторий:

git remote -v

Сменить адрес репозитория на ssh:

git remote set-url origin git@github.com:iridiumtechru/iridiumtechru.github.io.git

## Проверям пуш

<details>
    <summary>
        <code class="highlighter-rouge">
            git push origin
        </code>
    </summary>
    <pre class="highlight">
        <code>
            The authenticity of host 'github.com (192.30.253.113)' can't be established.
            RSA key fingerprint is SHA256:nThbg6kXUpJWGl7E1IGOCspRomTxdCARLviKw6E5SY8.
            Are you sure you want to continue connecting (yes/no)? yes
            Warning: Permanently added 'github.com,192.30.253.113' (RSA) to the list of known hosts.
            Everything up-to-date
        </code>
    </pre>
</details>

Будет запрошен пароль от сертификата.

## Инструкция для Windows

Тут немного сложнее т.к. инструменты для генерации ключей не распрастранены и в большинтсве совем представляют порты консольных приложений с Unix платформ. На помощь приходит Putty.

попытка запулитья с win заканчивается ошибкой

<!-- чем отличаются ssh-agentы -->

`git push origin`

The authenticity of host 'github.com (192.30.253.112)' can't be established.
RSA key fingerprint is SHA256:nThbg6kXUpJWGl7E1IGO1spRomTxdCARLviKw6E5SY8.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'github.com,192.30.253.112' (RSA) to the list of known hosts.
Enter passphrase for key '/c/Users/TECHRUMAIN/.ssh/id_rsa':

## Ссылки
1. [Linux puttygen](https://www.ssh.com/ssh/putty/linux/puttygen)
2. [Git ssh keys](https://help.github.com/articles/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent/#platform-linux)
3. ![win ssh invalid format](https://stackoverflow.com/questions/42863913/key-load-public-invalid-format)